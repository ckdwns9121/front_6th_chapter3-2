# 반복 일정 기능 TDD 진행 방안

## 📋 개요

이 문서는 반복 일정 기능 구현을 위한 TDD(Test-Driven Development) 진행 방안을 정의합니다.

## 🎯 요구사항

### 1. **(필수) 반복 유형 선택**

- 일정 생성 또는 수정 시 반복 유형을 선택할 수 있다.
- 반복 유형은 다음과 같다: 매일, 매주, 매월, 매년
  - 31일에 매월을 선택한다면 → 매월 마지막이 아닌, 31일에만 생성하세요.
  - 윤년 29일에 매년을 선택한다면 → 29일에만 생성하세요!

### 2. **(필수) 반복 일정 표시**

- 캘린더 뷰에서 반복 일정을 아이콘을 넣어 구분하여 표시한다.

### 3. **(필수) 반복 종료**

- 반복 종료 조건을 지정할 수 있다.
- 옵션: 특정 날짜까지
  - 예제 특성상, 2025-10-30까지 최대 일자를 만들어 주세요.

### 4. **(필수) 반복 일정 단일 수정**

- 반복일정을 수정하면 단일 일정으로 변경됩니다.
- 반복일정 아이콘도 사라집니다.

### 5. **(필수) 반복 일정 단일 삭제**

- 반복일정을 삭제하면 해당 일정만 삭제합니다.

## 🚀 TDD 사이클 계획

**Red → Green → Refactor** 사이클을 각 기능별로 진행:

1. **Red**: 실패하는 테스트 작성
2. **Green**: 테스트를 통과하는 최소한의 코드 구현
3. **Refactor**: 코드 개선 및 중복 제거

## 📊 테스트 우선순위 및 순서

### **Phase 1: 핵심 로직 테스트 (Unit Tests)**

```
1. 반복 일정 생성 로직 테스트
2. 날짜 계산 로직 테스트 (31일, 윤년 29일 처리)
3. 반복 종료 조건 테스트
4. 단일 수정/삭제 로직 테스트
```

### **Phase 2: 통합 테스트**

```
1. 이벤트 생성/수정/삭제 통합 테스트
2. 반복 일정 상태 관리 테스트
3. UI 상태 동기화 테스트
```

### **Phase 3: E2E 테스트**

```
1. 사용자 시나리오 기반 테스트
2. 반복 일정 전체 워크플로우 테스트
```

## 📝 상세 테스트 케이스

### **3.1 반복 일정 생성 로직 테스트**

```typescript
describe('generateRecurringEvents', () => {
  describe('매일 반복', () => {
    it('매일 반복 일정을 올바르게 생성한다', () => {
      // Given: 2025-01-01부터 2025-01-05까지 매일 반복
      // When: generateRecurringEvents 호출
      // Then: 5개의 일정이 생성되고 날짜가 올바르게 계산됨
    });
  });

  describe('매월 반복', () => {
    it('31일에 매월 반복 시 31일에만 생성한다', () => {
      // Given: 2025-01-31부터 매월 반복
      // When: generateRecurringEvents 호출
      // Then: 2월은 건너뛰고 3월 31일에 생성
    });

    it('30일에 매월 반복 시 모든 달에 생성한다', () => {
      // Given: 2025-01-30부터 매월 반복
      // When: generateRecurringEvents 호출
      // Then: 모든 달의 30일에 생성
    });
  });

  describe('매년 반복', () => {
    it('2월 29일에 매년 반복 시 윤년에만 생성한다', () => {
      // Given: 2024-02-29부터 매년 반복
      // When: generateRecurringEvents 호출
      // Then: 2025년은 2월 28일, 2028년은 2월 29일에 생성
    });
  });

  describe('반복 종료 조건', () => {
    it('2025-10-30까지 반복을 제한한다', () => {
      // Given: 2025-01-01부터 매일 반복, 종료일 2025-10-30
      // When: generateRecurringEvents 호출
      // Then: 2025-10-30까지만 생성됨
    });
  });
});
```

### **3.2 반복 일정 상태 관리 테스트**

```typescript
describe('반복 일정 상태 관리', () => {
  describe('단일 수정', () => {
    it('반복 일정을 수정하면 단일 일정으로 변경된다', () => {
      // Given: 반복 일정이 존재함
      // When: 특정 일정을 수정함
      // Then: 반복 아이콘이 사라지고 단일 일정이 됨
    });
  });

  describe('단일 삭제', () => {
    it('반복 일정을 삭제하면 해당 일정만 삭제된다', () => {
      // Given: 반복 일정 시리즈가 존재함
      // When: 특정 일정을 삭제함
      // Then: 해당 일정만 삭제되고 다른 반복 일정은 유지됨
    });
  });
});
```

## 🏗️ 구현 순서 및 의존성

### **4.1 1단계: 핵심 유틸리티 함수**

```
1. generateRecurringEvents 함수 개선
2. 날짜 계산 로직 수정 (31일, 윤년 29일 처리)
3. 반복 종료 조건 로직 구현
```

### **4.2 2단계: 상태 관리**

```
1. 반복 일정 식별자 추가
2. 단일 수정/삭제 상태 추적
3. 이벤트 상태 관리 로직 개선
```

### **4.3 3단계: UI 컴포넌트**

```
1. 반복 일정 아이콘 표시
2. 반복 설정 UI 활성화
3. 반복 일정 편집 UI 구현
```

## 🗂️ 테스트 환경 설정

### **5.1 테스트 파일 구조**

```
src/__tests__/
├── unit/
│   ├── recurringEvents.test.ts
│   ├── dateUtils.test.ts
│   └── eventOperations.test.ts
├── integration/
│   ├── eventManagement.test.ts
│   └── recurringEventWorkflow.test.ts
└── e2e/
    └── recurringEventScenarios.test.ts
```

### **5.2 테스트 데이터 팩토리**

```typescript
// test-utils/eventFactory.ts
export const createRecurringEvent = (overrides = {}) => ({
  id: 'test-event-1',
  title: '테스트 반복 일정',
  date: '2025-01-01',
  startTime: '09:00',
  endTime: '10:00',
  repeat: {
    type: 'daily' as RepeatType,
    interval: 1,
    endDate: '2025-10-30',
  },
  ...overrides,
});
```

## 📊 테스트 커버리지 목표

- **Unit Tests**: 90% 이상
- **Integration Tests**: 80% 이상
- **Critical Paths**: 100% (반복 일정 생성, 수정, 삭제)

## ✅ TDD 진행 단계별 체크리스트

### **Step 1: 반복 일정 생성 로직**

- [ ] 매일 반복 테스트 작성 및 통과
- [ ] 매주 반복 테스트 작성 및 통과
- [ ] 매월 반복 테스트 작성 및 통과 (31일 처리 포함)
- [ ] 매년 반복 테스트 작성 및 통과 (윤년 29일 처리 포함)
- [ ] 반복 종료 조건 테스트 작성 및 통과

### **Step 2: 상태 관리**

- [ ] 반복 일정 식별 테스트 작성 및 통과
- [ ] 단일 수정 상태 테스트 작성 및 통과
- [ ] 단일 삭제 상태 테스트 작성 및 통과

### **Step 3: UI 통합**

- [ ] 반복 일정 아이콘 표시 테스트 작성 및 통과
- [ ] 반복 설정 UI 테스트 작성 및 통과
- [ ] 반복 일정 편집 UI 테스트 작성 및 통과

## ⚠️ TDD 진행 시 주의사항

1. **작은 단위로 진행**: 한 번에 하나의 기능만 테스트하고 구현
2. **실패하는 테스트 먼저**: 테스트가 실패하는 것을 확인한 후 구현
3. **최소한의 구현**: 테스트를 통과하는 최소한의 코드만 작성
4. **지속적인 리팩토링**: 각 단계 후 코드 품질 개선
5. **의존성 최소화**: 테스트 간 의존성을 최소화하여 격리된 테스트 환경 구성

## 🔧 필요한 도구 및 설정

### **테스트 프레임워크**

- Jest (기본 테스트 러너)
- React Testing Library (컴포넌트 테스트)
- MSW (API 모킹)

### **테스트 유틸리티**

- `@testing-library/jest-dom` (DOM 매처)
- `@testing-library/user-event` (사용자 상호작용 시뮬레이션)

## 📚 참고 자료

- [Jest 공식 문서](https://jestjs.io/)
- [React Testing Library 공식 문서](https://testing-library.com/docs/react-testing-library/intro/)
- [TDD Best Practices](https://www.agilealliance.org/glossary/tdd/)

---

**문서 버전**: 1.0  
**최종 업데이트**: 2025-01-27  
**작성자**: AI Assistant  
**검토자**: 개발팀
